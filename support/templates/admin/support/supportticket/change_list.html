{% extends "admin/change_list.html" %}
{% load admin_urls static admin_list %}

{% block extrahead %}
    {{ block.super }}
    <style>
        .stats-dashboard {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #007cba;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #007cba;
        }
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        .no-data-message {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
            text-align: center;
        }
        .guide-steps {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 20px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .guide-steps ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        .guide-steps li {
            margin: 5px 0;
        }
    </style>
{% endblock %}

{% block content_title %}
    <h1>Gesti칩n de Tickets de Soporte - Galletas Kati</h1>
    
    {% if has_real_data %}
        <div class="stats-dashboard">
            <h2>游늵 Dashboard de Soporte en Tiempo Real</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">{{ total_tickets }}</div>
                    <div class="stat-label">Total Tickets</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ open_tickets }}</div>
                    <div class="stat-label">Tickets Abiertos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ resolved_tickets }}</div>
                    <div class="stat-label">Tickets Resueltos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ active_clients }}</div>
                    <div class="stat-label">Clientes Activos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ total_users }}</div>
                    <div class="stat-label">Total Usuarios</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ total_categories }}</div>
                    <div class="stat-label">Categor칤as Activas</div>
                </div>
            </div>
        </div>
    {% else %}
        <div class="no-data-message">
            <h2>游꿢 Sistema Listo - Iniciando con Datos Reales</h2>
            <p><strong>El sistema de soporte est치 configurado y listo para usar.</strong></p>
            <p>Actualmente no hay tickets reales en el sistema. Los datos de prueba han sido eliminados.</p>
        </div>
        
        <div class="guide-steps">
            <h3>游늶 C칩mo empezar a gestionar tickets reales:</h3>
            <ol>
                <li><strong>Los usuarios pueden crear tickets</strong> desde la interfaz de soporte</li>
                <li><strong>Los tickets aparecer치n autom치ticamente</strong> en esta secci칩n de administraci칩n</li>
                <li><strong>Como superusuario puedes:</strong>
                    <ul>
                        <li>Ver todos los tickets creados</li>
                        <li>Cambiar estados y prioridades</li>
                        <li>Asignar tickets a otros administradores</li>
                        <li>Responder y dar seguimiento</li>
                        <li>Ver el historial completo de conversaciones</li>
                    </ul>
                </li>
                <li><strong>Notificaciones autom치ticas:</strong> Los usuarios reciben emails cuando hay actualizaciones</li>
            </ol>
        </div>
        
        <div class="stats-dashboard">
            <h3>游늳 Estado Actual del Sistema</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">{{ total_users }}</div>
                    <div class="stat-label">Usuarios Registrados</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ total_categories }}</div>
                    <div class="stat-label">Categor칤as Configuradas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Tickets Pendientes</div>
                </div>
            </div>
        </div>
    {% endif %}
{% endblock %}

{% block content %}
    {{ block.super }}
{% endblock %}
